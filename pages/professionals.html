<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sahayata • Professionals</title>
  <link href="../assets/css/style.css" rel="stylesheet" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="../index.html"><span class="brand-mark">✦</span><span class="brand-text">Sahayata</span></a>
      <nav class="primary-nav" aria-label="Primary">
        <a href="./guide-enhanced.html" title="Personal Guide">Personal Guide</a>
        <a href="./samvad.html" title="Anonymous community">Samvad</a>
        <a href="./abhyas.html" title="Resilience toolkit">Abhyas</a>
        <a href="./journeys.html" title="Wellness journeys">Journeys</a>
        <a href="./professionals.html" aria-current="page" title="Therapists">Professional Connect</a>
  <a href="./section-5.html" title="Why Sahayata works">Why us</a>
        <a class="nav-cta" href="tel:18005990019" aria-label="Aapatkal – Call Tele MANAS 24 by 7">Aapatkal</a>
      </nav>
    </div>
  </header>
  <main class="container">
    <section class="hero">
      <h1>Trusted Professionals</h1>
      <p class="lead">Vetted therapists who understand student life. Browse profiles and schedule secure sessions, often at reduced cost through university partnerships.</p>
    </section>
    
    <section class="narrow">
      <div class="cta-inner">
        <div class="cta-text">
          <h2>Find the right fit</h2>
          <p>All professionals are licensed and carefully vetted for student-specific expertise.</p>
        </div>
        <div class="cta-actions">
          <select id="filter-speciality">
            <option value="">All specialities</option>
            <option value="anxiety">Anxiety & Stress</option>
            <option value="exam">Exam & Academic Pressure</option>
            <option value="depression">Depression & Mood</option>
            <option value="family">Family & Expectations</option>
            <option value="trauma">Trauma & Crisis</option>
          </select>
        </div>
      </div>
    </section>
    
    <section>
      <div id="list" class="grid"></div>
    </section>
    
    <section class="narrow about">
      <h2>Safe and confidential</h2>
      <p>Sessions are conducted through secure, encrypted video calls. Your privacy is protected at every step. University partnerships often provide subsidized rates to make professional help more accessible.</p>
    </section>
  </main>
  <footer class="site-footer"><div class="container footer-inner"><p>© <span id="year"></span> Sahayata</p></div></footer>
  <script type="module">
    import { api } from '../assets/js/app.js';
    import '../assets/js/main.js';
    const root = document.getElementById('list');
    const filter = document.getElementById('filter-speciality');
    let allProfessionals = [];
    
    async function load(){
      try {
        const res = await api.get('/api/professionals');
        allProfessionals = res.professionals && res.professionals.length ? res.professionals : getDefaultProfessionals();
      } catch(e) {
        console.warn('API failed, using default professionals:', e);
        allProfessionals = getDefaultProfessionals();
      }
      renderProfessionals(allProfessionals);
    }
    
    function getDefaultProfessionals() {
      return [
        { name:'Dr. Ananya Rao', speciality:'Anxiety, student life', languages:['English','Hindi'], price:799, experience:'8+ years', qualification:'M.D. Psychiatry' },
        { name:'Rahul Mehta, M.Phil (Clinical)', speciality:'Exam stress, placements', languages:['English','Hindi'], price:699, experience:'5+ years', qualification:'M.Phil Clinical Psychology' },
        { name:'Dr. Priya Sharma', speciality:'Depression, hostel adjustment', languages:['English','Hindi','Tamil'], price:849, experience:'10+ years', qualification:'Ph.D. Clinical Psychology' },
        { name:'Arjun Singh, RCI Licensed', speciality:'Family pressure, career anxiety', languages:['English','Hindi','Punjabi'], price:649, experience:'6+ years', qualification:'M.A. Psychology, RCI Licensed' },
        { name:'Dr. Meera Gupta', speciality:'Trauma, crisis intervention', languages:['English','Hindi','Bengali'], price:899, experience:'12+ years', qualification:'M.D. Psychiatry, Trauma Specialist' }
      ];
    }
    
    function bookSession(name, speciality) {
      const message = `Hello! I would like to book a session with ${name} for ${speciality}. Please let me know available slots and next steps.`;
      const whatsappUrl = `https://wa.me/918005990019?text=${encodeURIComponent(message)}`;
      
      if(confirm(`Book session with ${name}?\n\nThis will open WhatsApp to connect with our booking team. You can also call Tele-MANAS directly at 1800-599-0019 for immediate support.`)) {
        window.open(whatsappUrl, '_blank');
      }
    }
    
    function renderProfessionals(professionals){
      root.innerHTML = professionals.length ? professionals.map(p=>
        `<div class="card">
          <h3>${p.name}</h3>
          <p style="color:var(--brand-2); font-weight:600">${p.speciality||''}</p>
          <div style="margin:8px 0">
            <small style="color:var(--muted)">${p.qualification || ''}</small>
            <br>
            <small style="color:var(--muted)">${p.experience || ''}</small>
            <br>
            <small style="color:var(--muted)">Languages: ${(p.languages||[]).join(', ')}</small>
          </div>
          <div style="display:flex; justify-content:space-between; align-items:center; margin-top:12px">
            <span style="font-weight:700; color:var(--text)">₹${p.price||'—'}/session</span>
            <button class="btn btn-primary" onclick="bookSession('${p.name}', '${p.speciality}')">Book session</button>
          </div>
        </div>`
      ).join('') : '<p class="card">No professionals loaded yet. Run the seed script to populate sample data.</p>';
    }
    
    filter.addEventListener('change', () => {
      const speciality = filter.value.toLowerCase();
      const filtered = speciality ? 
        allProfessionals.filter(p => p.speciality && p.speciality.toLowerCase().includes(speciality)) : 
        allProfessionals;
      renderProfessionals(filtered);
    });
    
    // Global function for booking sessions
    window.bookSession = function(name, speciality) {
      const message = `Hello! I would like to book a session with ${name} for ${speciality}. Please let me know available slots and next steps.`;
      const whatsappUrl = `https://wa.me/918005990019?text=${encodeURIComponent(message)}`;
      
      if(confirm(`Book session with ${name}?\n\nThis will open WhatsApp to connect with our booking team. You can also call Tele-MANAS directly at 1800-599-0019 for immediate support.`)) {
        window.open(whatsappUrl, '_blank');
      }
    };
    
    load();
  </script>
</body>
</html>
