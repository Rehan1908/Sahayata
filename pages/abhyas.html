<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sahayata ‚Ä¢ Abhyas Toolkit</title>
  <link href="../assets/css/style.css" rel="stylesheet" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="../index.html"><span class="brand-mark">‚ú¶</span><span class="brand-text">Sahayata</span></a>
      <nav class="primary-nav" aria-label="Primary">
        <a href="./guide.html" title="Personal Guide">Personal Guide</a>
        <a href="./samvad.html" title="Anonymous community">Samvad</a>
        <a href="./abhyas.html" aria-current="page" title="Resilience toolkit">Abhyas</a>
        <a href="./journeys.html" title="Wellness journeys">Journeys</a>
        <a href="./professionals.html" title="Therapists">Professional Connect</a>
        <a href="./section-5.html" title="Why Sahayata works">Why us</a>
        <div class="user-menu">
          <span class="user-name"></span>
          <a href="#" class="logout-btn">Sign Out</a>
        </div>
        <a class="btn btn-ghost" href="./auth.html" id="auth-link">Sign In</a>
        <a class="nav-cta" href="tel:18005990019" aria-label="Aapatkal ‚Äì Call Tele MANAS 24 by 7">Aapatkal</a>
      </nav>
    </div>
  </header>
  <main class="container">
    <section class="hero">
      <h1>Abhyas Toolkit</h1>
      <p class="lead">Evidence‚Äëbased practices to build real, lasting coping skills. Interactive tools for mindfulness, thought work, and resilience.</p>
    </section>
    
    <section>
      <div class="narrow">
        <div class="cta-inner">
          <div class="cta-text">
            <h2>Choose by how you're feeling</h2>
            <p>Pick tools that match what you need right now.</p>
          </div>
          <div class="cta-actions">
            <select id="filter-type">
              <option value="">All tools</option>
              <option value="meditation">Meditations</option>
              <option value="guide">Guides</option>
              <option value="journal">Journaling</option>
              <option value="exercise">Exercises</option>
            </select>
          </div>
        </div>
      </div>
    </section>

    <section>
      <div id="tools" class="grid"></div>
    </section>

    <section class="narrow about">
      <h2>About these practices</h2>
      <p>Each tool is based on proven therapeutic techniques adapted specifically for student life. These aren't just articles‚Äîthey're active exercises designed to build skills you can use immediately and for life.</p>
      
      <div style="margin-top: 30px; padding: 20px; background: rgba(220, 38, 127, 0.1); border-radius: 8px; border-left: 4px solid var(--brand);">
        <h3 style="color: var(--brand); margin-top: 0;">üÜò Need Immediate Help?</h3>
        <p><strong>Crisis Support:</strong></p>
        <ul style="margin: 10px 0;">
          <li><strong>Tele-MANAS:</strong> <a href="tel:14416" style="color: var(--brand); font-weight: 600;">14416</a> (24/7 National Mental Health Helpline)</li>
          <li><strong>Emergency:</strong> <a href="tel:112" style="color: var(--brand); font-weight: 600;">112</a> (Police/Medical Emergency)</li>
          <li><strong>NIMHANS Helpline:</strong> <a href="tel:+918025564447" style="color: var(--brand); font-weight: 600;">080-2556-4447</a></li>
          <li><strong>Vandrevala Foundation:</strong> <a href="tel:+919999666555" style="color: var(--brand); font-weight: 600;">9999-666-555</a> (24/7 Free Counseling)</li>
        </ul>
        <p style="font-size: 14px; margin-bottom: 0;"><em>Remember: Reaching out for help is a sign of strength, not weakness. You matter and your life has value.</em></p>
      </div>
      
      <div style="margin-top: 20px; padding: 20px; background: rgba(52, 152, 219, 0.1); border-radius: 8px; border-left: 4px solid #3498db;">
        <h3 style="color: #3498db; margin-top: 0;">üîó Trusted Mental Health Resources</h3>
        <div style="display: grid; gap: 15px; margin-top: 15px;">
          <div>
            <strong>üè• Professional Organizations:</strong><br>
            <a href="https://www.nimhans.ac.in/" target="_blank" style="color: #3498db;">NIMHANS</a> - National Institute of Mental Health<br>
            <a href="https://indianpsychiatryassociation.com/" target="_blank" style="color: #3498db;">Indian Psychiatric Association</a> - Find qualified psychiatrists
          </div>
          <div>
            <strong>üì± Verified Apps & Platforms:</strong><br>
            <a href="https://www.7cups.com/" target="_blank" style="color: #3498db;">7 Cups</a> - Free emotional support<br>
            <a href="https://www.yourdost.com/" target="_blank" style="color: #3498db;">YourDOST</a> - Online counseling for students<br>
            <a href="https://www.manasthali.org/" target="_blank" style="color: #3498db;">Manasthali</a> - Mental health support in Indian languages
          </div>
          <div>
            <strong>üìö Self-Help Resources:</strong><br>
            <a href="https://www.cci.health.wa.gov.au/Resources/Looking-After-Yourself" target="_blank" style="color: #3498db;">CCI Self-Help Workbooks</a> - Free CBT workbooks<br>
            <a href="https://www.mindful.org/" target="_blank" style="color: #3498db;">Mindful.org</a> - Meditation and mindfulness guides
          </div>
        </div>
      </div>
    </section>
  </main>
  <footer class="site-footer"><div class="container footer-inner"><p>¬© <span id="year"></span> Sahayata</p></div></footer>
  
  <!-- Script dependencies -->
  <script src="../assets/js/particles.js"></script>
  <script src="../assets/js/main.js"></script>
  <script src="../assets/js/auth.js"></script>
  
  <script type="module">
    import { api, getUserId } from '../assets/js/app.js';
    const root = document.getElementById('tools');
    const filter = document.getElementById('filter-type');
    let allTools = [];
    
    async function load(){
      try {
        const res = await api.get('/api/abhyas');
        allTools = res.tools || getDefaultTools();
      } catch(e) {
        console.warn('API failed, using default tools:', e);
        allTools = getDefaultTools();
      }
      renderTools(allTools);
    }
    
    function getDefaultTools() {
      return [
        { key:'breathing', title:'Guided breathing meditation', type:'meditation', minutes:2, description:'Calm your racing mind with gentle breath awareness' },
        { key:'quick-relaxation', title:'Stress relief meditation', type:'meditation', minutes:5, description:'Quick guided meditation to release tension and anxiety' },
        { key:'thought-diary', title:'CBT thought diary worksheet', type:'journal', minutes:10, description:'Identify and challenge negative thinking patterns' },
        { key:'mindful-study', title:'Mindful studying technique', type:'guide', minutes:5, description:'Study with focus and less anxiety using mindfulness' },
        { key:'exam-anxiety', title:'Exam anxiety management guide', type:'guide', minutes:7, description:'NIMHANS guide for handling exam stress and panic' },
        { key:'placement-stress', title:'Job search stress management', type:'guide', minutes:8, description:'Navigate placement pressure and career anxiety' },
        { key:'sleep-hygiene', title:'Better sleep for students', type:'guide', minutes:6, description:'Improve sleep quality in hostel and dorm environments' },
        { key:'time-management', title:'Time management mastery', type:'guide', minutes:10, description:'Balance academics, social life, and self-care effectively' },
        { key:'gratitude-practice', title:'Daily gratitude journal', type:'exercise', minutes:3, description:'Build resilience through appreciation practice' },
        { key:'hostel-loneliness', title:'Overcoming loneliness', type:'guide', minutes:8, description:'Connect with others and build meaningful relationships' },
        { key:'parental-pressure', title:'Managing family expectations', type:'guide', minutes:6, description:'Navigate parental pressure while maintaining mental health' },
        { key:'panic-help', title:'Panic attack emergency toolkit', type:'exercise', minutes:3, description:'Immediate techniques to manage panic and overwhelming anxiety' },
        { key:'crisis-support', title:'24/7 Crisis helpline access', type:'exercise', minutes:1, description:'Direct access to Tele-MANAS national mental health support' },
        { key:'self-harm-help', title:'Self-harm support resources', type:'guide', minutes:5, description:'Professional resources for those struggling with self-injury' },
        { key:'depression-help', title:'Understanding depression', type:'guide', minutes:10, description:'NIMHANS self-help guide for recognizing and managing depression' }
      ];
    }
    
    function getToolAction(key) {
      const actions = {
        'breathing': 'https://www.youtube.com/watch?v=YRPh_GaiL8s', // 2-minute breathing meditation
        'quick-relaxation': 'https://www.headspace.com/meditation/stress', // Stress relief meditation
        'thought-diary': 'https://www.cci.health.wa.gov.au/Resources/Looking-After-Yourself/Depression', // CBT thought diary resources
        'mindful-study': 'https://www.mindful.org/how-to-meditate/', // Mindfulness for focus
        'exam-anxiety': 'https://www.nimhans.ac.in/wp-content/uploads/2020/04/Exam-Anxiety-Tips.pdf', // NIMHANS exam anxiety guide
        'placement-stress': 'https://www.betterhelp.com/advice/stress/how-to-cope-with-job-search-stress/', // Career stress management
        'sleep-hygiene': 'https://www.sleepfoundation.org/how-sleep-works/sleep-hygiene-tips', // Sleep hygiene guide
        'time-management': 'https://www.coursera.org/learn/time-management', // Time management course
        'gratitude-practice': 'https://ggia.berkeley.edu/practice/gratitude_journal', // UC Berkeley gratitude practice
        'hostel-loneliness': 'https://www.7cups.com/', // Free emotional support
        'parental-pressure': 'https://www.nimhans.ac.in/mental-health-resources/', // NIMHANS mental health resources
        'panic-help': 'https://www.anxietycanada.com/articles/managing-panic-attacks/', // Panic attack management
        'crisis-support': 'tel:14416', // Tele-MANAS helpline
        'self-harm-help': 'https://www.befrienders.org/need-to-talk', // Crisis support resources
        'depression-help': 'https://www.nimhans.ac.in/wp-content/uploads/2020/04/Depression-Self-Help.pdf' // NIMHANS depression guide
      };
      return actions[key];
    }
    
    function renderTools(tools){
      root.innerHTML = tools.map(t=>
        `<div class="card" id="${t.key}">
          <h3>${t.title}</h3>
          <p>${t.description || ''}</p>
          <div style="display:flex; justify-content:space-between; align-items:center; margin-top:12px">
            <small style="color:var(--muted)">${t.type} ‚Ä¢ ${t.minutes} min</small>
            <button class="btn btn-primary" data-key="${t.key}">Do it</button>
          </div>
        </div>`
      ).join('');
      
      root.querySelectorAll('button[data-key]').forEach(btn=>btn.addEventListener('click', async () => {
        const key = btn.dataset.key;
        btn.disabled = true;
        btn.textContent = 'Working...';
        
        try {
          const userId = getUserId();
          if (!userId) {
            console.log('No user ID available');
            return;
          }
          await api.post('/api/abhyas', { sessionId: userId, key });
        } catch(e) {
          console.warn('API failed, but continuing:', e);
          // Continue anyway - the important thing is the user gets the tool
        }
        
        btn.textContent='Completed ‚úì';
        btn.style.background = 'var(--brand-2)';
        
        // Show brief encouragement
        const card = btn.closest('.card');
        const encouragement = document.createElement('small');
        encouragement.textContent = 'üåü Great work! This practice builds over time.';
        encouragement.style.color = 'var(--brand-2)';
        encouragement.style.display = 'block';
        encouragement.style.marginTop = '8px';
        encouragement.style.fontWeight = '600';
        card.appendChild(encouragement);
        
        // Simulate opening the tool (you could link to actual tool pages)
        setTimeout(() => {
          const toolAction = getToolAction(key);
          if(toolAction) {
            window.open(toolAction, '_blank');
          }
        }, 500);
      }));
      
      // Handle URL hash highlighting
      if(location.hash){
        const id = location.hash.slice(1);
        const el = document.getElementById(id);
        if(el){
          el.classList.add('highlight');
          el.scrollIntoView({ behavior:'smooth', block:'start' });
          setTimeout(()=> el.classList.remove('highlight'), 2200);
        }
      }
    }
    
    filter.addEventListener('change', () => {
      const type = filter.value;
      const filtered = type ? allTools.filter(t => t.type === type) : allTools;
      renderTools(filtered);
    });
    
    load();
  </script>
</body>
</html>
